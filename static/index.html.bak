<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Houseboat Management — Admin</title>
  <style>
    :root{--bg:#f7fafc;--card:#ffffff;--accent:#0b5cff;--muted:#64748b;--danger:#ef4444;--glass:rgba(11,92,255,0.08)}
    html,body{height:100%;margin:0;font-family:Inter,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:#0f172a}
    .app{display:grid;grid-template-columns:260px 1fr;gap:18px;height:100vh}
    .sidebar{background:var(--card);padding:18px;border-right:1px solid #e6edf3;box-shadow:0 6px 18px rgba(2,6,23,0.04);display:flex;flex-direction:column}
    .brand{font-weight:700;font-size:18px;margin-bottom:12px}
    .nav{display:flex;flex-direction:column;gap:6px}
    .nav button{background:transparent;border:none;padding:10px 12px;text-align:left;border-radius:8px;cursor:pointer;color:var(--muted);font-weight:600}
    .nav button.active{background:var(--glass);color:var(--accent)}
    .content{padding:20px;overflow:auto}
    .topbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
    .search{display:flex;gap:8px;align-items:center}
    .card{background:var(--card);padding:16px;border-radius:10px;border:1px solid #e6edf3;box-shadow:0 6px 18px rgba(2,6,23,0.02)}
    h2{margin:0 0 12px;font-size:16px}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .btn{background:var(--accent);color:white;border:none;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:700}
    .btn.ghost{background:transparent;color:var(--accent);border:1px solid rgba(11,92,255,0.12)}
    table{width:100%;border-collapse:collapse}
    th,td{padding:8px 10px;text-align:left;border-bottom:1px solid #f1f5f9;font-size:13px}
    form{display:grid;gap:10px}
    label{font-size:13px;color:var(--muted)}
    input,select,textarea{padding:10px;border-radius:8px;border:1px solid #e6edf3;background:white;font-size:14px}
    .toolbar{display:flex;gap:8px;align-items:center}
    .muted{color:var(--muted);font-size:13px}
    .small{font-size:12px;color:var(--muted)}
    .grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    /* responsive */
    @media (max-width:900px){.app{grid-template-columns:1fr} .sidebar{display:flex;flex-direction:row;gap:8px;overflow:auto;height:auto}.grid-3{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="brand">Houseboat Management</div>
      <nav class="nav" role="navigation" aria-label="Primary">
        <button class="nav-btn active" data-view="dashboard">Dashboard</button>
        <button class="nav-btn" data-view="owners">Owners</button>
        <button class="nav-btn" data-view="boats">Boats</button>
        <button class="nav-btn" data-view="clients">Clients</button>
        <button class="nav-btn" data-view="routes">Routes</button>
        <button class="nav-btn" data-view="services">Services</button>
        <button class="nav-btn" data-view="bookings">Bookings</button>
      </nav>
      <div style="flex:1"></div>
      <div class="small muted">v1.0 • Local demo</div>
    </aside>

    <main class="content">
      <div class="topbar">
        <div>
          <h2 id="view-title">Dashboard</h2>
          <div class="small muted" id="view-sub">Overview of boats, bookings and revenue</div>
        </div>
        <div class="toolbar">
          <input id="globalSearch" placeholder="Search..." style="padding:8px 10px;border-radius:8px;border:1px solid #e6edf3" />
          <button class="btn ghost" id="refreshBtn">Refresh</button>
        </div>
      </div>

      <!-- Views container -->
      <section id="views">
        <!-- Dashboard -->
        <div class="view" data-view="dashboard">
          <div class="grid-3">
            <div class="card">
              <div class="muted">Total Boats</div>
              <div style="font-size:22px;font-weight:800" id="stat-boats">—</div>
            </div>
            <div class="card">
              <div class="muted">Active Bookings</div>
              <div style="font-size:22px;font-weight:800" id="stat-bookings">—</div>
            </div>
            <div class="card">
              <div class="muted">Clients</div>
              <div style="font-size:22px;font-weight:800" id="stat-clients">—</div>
            </div>
          </div>

          <div style="height:18px"></div>
          <div class="card">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
              <div><strong>Recent Bookings</strong><div class="small muted">Most recent 10</div></div>
              <div><button class="btn" data-action="goto" data-view="bookings">View all</button></div>
            </div>
            <table id="recentBookings"><thead><tr><th>ID</th><th>Client</th><th>Boat</th><th>From</th><th>Status</th></tr></thead><tbody><tr><td colspan="5" class="small muted">No data</td></tr></tbody></table>
          </div>
        </div>

        <!-- Owners -->
        <div class="view" style="display:none" data-view="owners">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
            <div><strong>Owners</strong><div class="small muted">Manage boat owners</div></div>
            <div><button class="btn" data-action="new" data-entity="owner">+ New Owner</button></div>
          </div>
          <div class="card" id="ownersList"><table><thead><tr><th>ID</th><th>Name</th><th>License</th><th>DOB</th><th></th></tr></thead><tbody><tr><td colspan="5" class="small muted">No owners yet</td></tr></tbody></table></div>

          <div style="height:12px"></div>
          <div class="card" id="ownerFormWrap" style="display:none">
            <h3>Create Owner</h3>
            <form id="ownerForm">
              <label>Name<input name="owner_name" required></label>
              <label>License No<input name="license_no"></label>
              <label>Date of Birth<input name="dob" type="date"></label>
              <div style="display:flex;gap:8px;margin-top:8px"><button class="btn" type="submit">Save</button><button type="button" class="btn ghost" data-action="cancel-form">Cancel</button></div>
            </form>
          </div>
        </div>

        <!-- Boats -->
        <div class="view" style="display:none" data-view="boats">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
            <div><strong>Boats</strong><div class="small muted">Register and assign services</div></div>
            <div><button class="btn" data-action="new" data-entity="boat">+ New Boat</button></div>
          </div>
          <div class="card" id="boatsList"><table><thead><tr><th>ID</th><th>Number</th><th>Capacity</th><th>Owner</th><th>Service</th><th></th></tr></thead><tbody><tr><td colspan="6" class="small muted">No boats yet</td></tr></tbody></table></div>

          <div style="height:12px"></div>
          <div class="card" id="boatFormWrap" style="display:none">
            <h3>New Boat</h3>
            <form id="boatForm">
              <label>Boat Number<input name="boat_number" required></label>
              <label>Capacity<input name="capacity" type="number" min="1"></label>
              <label>Owner<select name="owner_id"></select></label>
              <label>Service<select name="service_id"></select></label>
              <div style="display:flex;gap:8px;margin-top:8px"><button class="btn" type="submit">Save</button><button type="button" class="btn ghost" data-action="cancel-form">Cancel</button></div>
            </form>
          </div>
        </div>

        <!-- Clients -->
        <div class="view" style="display:none" data-view="clients">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
            <div><strong>Clients</strong><div class="small muted">Guest records</div></div>
            <div><button class="btn" data-action="new" data-entity="client">+ New Client</button></div>
          </div>
          <div class="card" id="clientsList"><table><thead><tr><th>ID</th><th>Name</th><th>Phone</th><th>City</th><th></th></tr></thead><tbody><tr><td colspan="5" class="small muted">No clients yet</td></tr></tbody></table></div>

          <div style="height:12px"></div>
          <div class="card" id="clientFormWrap" style="display:none">
            <h3>New Client</h3>
            <form id="clientForm">
              <label>First Name<input name="first_name" required></label>
              <label>Last Name<input name="last_name"></label>
              <label>Phone<input name="phone"></label>
              <label>City<input name="city"></label>
              <label>Country<input name="country"></label>
              <label>DOB<input name="dob" type="date"></label>
              <div style="display:flex;gap:8px;margin-top:8px"><button class="btn" type="submit">Save</button><button type="button" class="btn ghost" data-action="cancel-form">Cancel</button></div>
            </form>
          </div>
        </div>

        <!-- Routes -->
        <div class="view" style="display:none" data-view="routes">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
            <div><strong>Routes</strong><div class="small muted">Source, destination and spots</div></div>
            <div><button class="btn" data-action="new" data-entity="route">+ New Route</button></div>
          </div>
          <div class="card" id="routesList"><table><thead><tr><th>ID</th><th>Source</th><th>Destination</th><th>Spots</th><th></th></tr></thead><tbody><tr><td colspan="5" class="small muted">No routes yet</td></tr></tbody></table></div>

          <div style="height:12px"></div>
          <div class="card" id="routeFormWrap" style="display:none">
            <h3>New Route</h3>
            <form id="routeForm">
              <label>Source<input name="source" required></label>
              <label>Destination<input name="destination" required></label>
              <label>Spots (comma separated)<input name="spots"></label>
              <div style="display:flex;gap:8px;margin-top:8px"><button class="btn" type="submit">Save</button><button type="button" class="btn ghost" data-action="cancel-form">Cancel</button></div>
            </form>
          </div>
        </div>

        <!-- Services -->
        <div class="view" style="display:none" data-view="services">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
            <div><strong>Services</strong><div class="small muted">Add service packages</div></div>
            <div><button class="btn" data-action="new" data-entity="service">+ New Service</button></div>
          </div>
          <div class="card" id="servicesList"><table><thead><tr><th>ID</th><th>Type</th><th>Wifi</th><th>Rate</th><th></th></tr></thead><tbody><tr><td colspan="5" class="small muted">No services yet</td></tr></tbody></table></div>

          <div style="height:12px"></div>
          <div class="card" id="serviceFormWrap" style="display:none">
            <h3>New Service</h3>
            <form id="serviceForm">
              <label>Service Type<input name="service_type" required></label>
              <label>Wifi Bandwidth<input name="wifi_bandwidth"></label>
              <label>Cuisine<input name="cuisine"></label>
              <label>Has Bar<select name="has_bar"><option value="0">No</option><option value="1">Yes</option></select></label>
              <label>Rate<input name="rate" type="number" step="0.01"></label>
              <div style="display:flex;gap:8px;margin-top:8px"><button class="btn" type="submit">Save</button><button type="button" class="btn ghost" data-action="cancel-form">Cancel</button></div>
            </form>
          </div>
        </div>

        <!-- Bookings -->
        <div class="view" style="display:none" data-view="bookings">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
            <div><strong>Bookings</strong><div class="small muted">Create and manage bookings</div></div>
            <div><button class="btn" data-action="new" data-entity="booking">+ New Booking</button></div>
          </div>
          <div class="card" id="bookingsList"><table><thead><tr><th>ID</th><th>Client</th><th>Boat</th><th>Route</th><th>From</th><th>Status</th><th></th></tr></thead><tbody><tr><td colspan="7" class="small muted">No bookings yet</td></tr></tbody></table></div>

          <div style="height:12px"></div>
          <div class="card" id="bookingFormWrap" style="display:none">
            <h3>New Booking</h3>
            <form id="bookingForm">
              <label>Client<select name="client_id"></select></label>
              <label>Boat<select name="boat_id"></select></label>
              <label>Route<select name="route_id"></select></label>
              <label>From Date<input name="from_date" type="datetime-local" required></label>
              <label>To Date<input name="to_date" type="datetime-local"></label>
              <label>Payment Type<select name="payment_type"><option>cash</option><option>card</option><option>online</option></select></label>
              <label>Payment Status<select name="payment_status"><option>pending</option><option>paid</option><option>cancelled</option></select></label>
              <label>Amount<input name="payment_amount" type="number" step="0.01"></label>
              <div style="display:flex;gap:8px;margin-top:8px"><button class="btn" type="submit">Save</button><button type="button" class="btn ghost" data-action="cancel-form">Cancel</button></div>
            </form>
          </div>
        </div>

      </section>

    </main>
  </div>

  <script>
    // Simple client-side router + UI wiring
    (function(){
      const navBtns = document.querySelectorAll('.nav-btn');
      const views = document.querySelectorAll('.view');
      const title = document.getElementById('view-title');
      const subtitle = document.getElementById('view-sub');

      function showView(name){
        views.forEach(v=>v.style.display = v.dataset.view === name ? '' : 'none');
        navBtns.forEach(b=>b.classList.toggle('active', b.dataset.view === name));
        title.textContent = name.charAt(0).toUpperCase() + name.slice(1);
        // update subtitle quickly
        subtitle.textContent = ({dashboard:'Overview of boats, bookings and revenue', owners:'Manage owners', boats:'Manage boats', clients:'Manage clients', routes:'Manage routes', services:'Manage services', bookings:'Manage bookings'})[name] || '';
      }

      navBtns.forEach(b=>b.addEventListener('click',()=>showView(b.dataset.view)));
      document.querySelectorAll('[data-action="goto"]').forEach(b=>b.addEventListener('click',e=>showView(e.target.dataset.view)));

      // Form toggles for new entities
      document.querySelectorAll('[data-action="new"]').forEach(btn=>{
        btn.addEventListener('click',()=>{
          const entity = btn.dataset.entity;
          openForm(entity);
        });
      });

      document.querySelectorAll('[data-action="cancel-form"]').forEach(btn=>btn.addEventListener('click',closeAllForms));

      function openForm(entity){
        closeAllForms();
        switch(entity){
          case 'owner': document.getElementById('ownerFormWrap').style.display='block';showView('owners');break;
          case 'boat': populateOwnerServiceSelects();document.getElementById('boatFormWrap').style.display='block';showView('boats');break;
          case 'client': document.getElementById('clientFormWrap').style.display='block';showView('clients');break;
          case 'route': document.getElementById('routeFormWrap').style.display='block';showView('routes');break;
          case 'service': document.getElementById('serviceFormWrap').style.display='block';showView('services');break;
          case 'booking': populateBookingSelects();document.getElementById('bookingFormWrap').style.display='block';showView('bookings');break;
        }
      }
      function closeAllForms(){document.querySelectorAll('[id$="FormWrap"]').forEach(el=>el.style.display='none');}

      // Form submit handlers
      document.getElementById('ownerForm')?.addEventListener('submit',e=>{e.preventDefault();const f=new FormData(e.target);state.owners.push({id:idCounters.owners++,name:f.get('owner_name'),license:f.get('license_no'),dob:f.get('dob')});refreshAll();e.target.reset();closeAllForms();});
      document.getElementById('boatForm')?.addEventListener('submit',e=>{e.preventDefault();const f=new FormData(e.target);state.boats.push({id:idCounters.boats++,boat_number:f.get('boat_number'),capacity:parseInt(f.get('capacity')||0),owner_id:parseInt(f.get('owner_id')||0),service_id:parseInt(f.get('service_id')||0)});refreshAll();e.target.reset();closeAllForms();});
      document.getElementById('clientForm')?.addEventListener('submit',e=>{e.preventDefault();const f=new FormData(e.target);state.clients.push({id:idCounters.clients++,first_name:f.get('first_name'),last_name:f.get('last_name'),phone:f.get('phone'),city:f.get('city')});refreshAll();e.target.reset();closeAllForms();});
      document.getElementById('routeForm')?.addEventListener('submit',e=>{e.preventDefault();const f=new FormData(e.target);state.routes.push({id:idCounters.routes++,source:f.get('source'),destination:f.get('destination'),spots:(f.get('spots')||'').split(',').map(s=>s.trim()).filter(Boolean)});refreshAll();e.target.reset();closeAllForms();});
      document.getElementById('serviceForm')?.addEventListener('submit',e=>{e.preventDefault();const f=new FormData(e.target);state.services.push({id:idCounters.services++,service_type:f.get('service_type'),wifi_bandwidth:f.get('wifi_bandwidth'),cuisine:f.get('cuisine'),has_bar:!!parseInt(f.get('has_bar')),rate:parseFloat(f.get('rate')||0)});refreshAll();e.target.reset();closeAllForms();});
      document.getElementById('bookingForm')?.addEventListener('submit',e=>{e.preventDefault();const f=new FormData(e.target);state.bookings.push({id:idCounters.bookings++,client_id:parseInt(f.get('client_id')||0),boat_id:parseInt(f.get('boat_id')||0),route_id:parseInt(f.get('route_id')||0),from_date:f.get('from_date'),to_date:f.get('to_date'),payment_type:f.get('payment_type'),payment_status:f.get('payment_status'),payment_amount:parseFloat(f.get('payment_amount')||0)});refreshAll();e.target.reset();closeAllForms();});

      function populateOwnerServiceSelects(){
        const ownerSelects = document.querySelectorAll('select[name="owner_id"]');ownerSelects.forEach(s=>{s.innerHTML='';s.append(new Option('-- select owner --',''));state.owners.forEach(o=>s.append(new Option(o.name,o.id)));});
        const serviceSelects = document.querySelectorAll('select[name="service_id"]');serviceSelects.forEach(s=>{s.innerHTML='';s.append(new Option('-- select service --',''));state.services.forEach(svc=>s.append(new Option(svc.service_type,svc.id)));});
      }
      function populateBookingSelects(){
        const csel=document.querySelector('select[name="client_id"]');const bsel=document.querySelector('select[name="boat_id"]');const rsel=document.querySelector('select[name="route_id"]');if(csel){csel.innerHTML='';state.clients.forEach(c=>csel.append(new Option((c.first_name||'') + ' ' + (c.last_name||''),c.id)));}
        if(bsel){bsel.innerHTML='';state.boats.forEach(b=>bsel.append(new Option(b.boat_number||('Boat '+b.id),b.id)));}
        if(rsel){rsel.innerHTML='';state.routes.forEach(r=>rsel.append(new Option(r.source+' → '+r.destination,r.id)));}
      }

      // Refresh UI lists
      function refreshAll(){
        // stats
        document.getElementById('stat-boats').textContent = state.boats.length;
        document.getElementById('stat-bookings').textContent = state.bookings.length;
        document.getElementById('stat-clients').textContent = state.clients.length;

        // owners table
        const ownersTb = document.querySelector('#ownersList tbody');ownersTb.innerHTML='';if(state.owners.length===0){ownersTb.innerHTML='<tr><td colspan="5" class="small muted">No owners yet</td></tr>'}else{state.owners.forEach(o=>{const tr=document.createElement('tr');tr.innerHTML=`<td>${o.id}</td><td>${o.name||''}</td><td>${o.license||''}</td><td>${o.dob||''}</td><td><button data-action="del-owner" data-id="${o.id}" class="btn ghost">Delete</button></td>`;ownersTb.appendChild(tr)})}

        // boats table
        const boatsTb = document.querySelector('#boatsList tbody');boatsTb.innerHTML='';if(state.boats.length===0){boatsTb.innerHTML='<tr><td colspan="6" class="small muted">No boats yet</td></tr>'}else{state.boats.forEach(b=>{const owner = state.owners.find(o=>o.id===b.owner_id);const svc = state.services.find(s=>s.id===b.service_id);const tr=document.createElement('tr');tr.innerHTML=`<td>${b.id}</td><td>${b.boat_number||''}</td><td>${b.capacity||''}</td><td>${owner?owner.name:''}</td><td>${svc?svc.service_type:''}</td><td><button data-action="del-boat" data-id="${b.id}" class="btn ghost">Delete</button></td>`;boatsTb.appendChild(tr)})}

        // clients table
        const clientsTb = document.querySelector('#clientsList tbody');clientsTb.innerHTML='';if(state.clients.length===0){clientsTb.innerHTML='<tr><td colspan="5" class="small muted">No clients yet</td></tr>'}else{state.clients.forEach(c=>{const tr=document.createElement('tr');tr.innerHTML=`<td>${c.id}</td><td>${c.first_name} ${c.last_name||''}</td><td>${c.phone||''}</td><td>${c.city||''}</td><td><button data-action="del-client" data-id="${c.id}" class="btn ghost">Delete</button></td>`;clientsTb.appendChild(tr)})}

        // routes table
        const routesTb = document.querySelector('#routesList tbody');routesTb.innerHTML='';if(state.routes.length===0){routesTb.innerHTML='<tr><td colspan="5" class="small muted">No routes yet</td></tr>'}else{state.routes.forEach(r=>{const tr=document.createElement('tr');tr.innerHTML=`<td>${r.id}</td><td>${r.source}</td><td>${r.destination}</td><td>${(r.spots||[]).join(', ')}</td><td><button data-action="del-route" data-id="${r.id}" class="btn ghost">Delete</button></td>`;routesTb.appendChild(tr)})}

        // services table
        const servicesTb = document.querySelector('#servicesList tbody');servicesTb.innerHTML='';if(state.services.length===0){servicesTb.innerHTML='<tr><td colspan="5" class="small muted">No services yet</td></tr>'}else{state.services.forEach(svc=>{const tr=document.createElement('tr');tr.innerHTML=`<td>${svc.id}</td><td>${svc.service_type}</td><td>${svc.wifi_bandwidth||''}</td><td>${svc.rate||''}</td><td><button data-action="del-service" data-id="${svc.id}" class="btn ghost">Delete</button></td>`;servicesTb.appendChild(tr)})}

        // bookings table
        const bookingsTb = document.querySelector('#bookingsList tbody');bookingsTb.innerHTML='';if(state.bookings.length===0){bookingsTb.innerHTML='<tr><td colspan="7" class="small muted">No bookings yet</td></tr>'}else{state.bookings.forEach(bk=>{const client = state.clients.find(c=>c.id===bk.client_id);const boat = state.boats.find(bt=>bt.id===bk.boat_id);const route = state.routes.find(r=>r.id===bk.route_id);const tr=document.createElement('tr');tr.innerHTML=`<td>${bk.id}</td><td>${client?client.first_name:''}</td><td>${boat?boat.boat_number:''}</td><td>${route?route.source+'→'+route.destination:''}</td><td>${bk.from_date||''}</td><td>${bk.payment_status||''}</td><td><button data-action="del-booking" data-id="${bk.id}" class="btn ghost">Delete</button></td>`;bookingsTb.appendChild(tr)})}

        // recent bookings
        const recentTb = document.querySelector('#recentBookings tbody');recentTb.innerHTML='';const recent = state.bookings.slice(-10).reverse();if(recent.length===0){recentTb.innerHTML='<tr><td colspan="5" class="small muted">No data</td></tr>'}else{recent.forEach(bk=>{const c=state.clients.find(x=>x.id===bk.client_id);const boat=state.boats.find(x=>x.id===bk.boat_id);const tr=document.createElement('tr');tr.innerHTML=`<td>${bk.id}</td><td>${c?c.first_name+' '+(c.last_name||''):''}</td><td>${boat?boat.boat_number:''}</td><td>${bk.from_date||''}</td><td>${bk.payment_status||''}</td>`;recentTb.appendChild(tr)})}

        populateOwnerServiceSelects();populateBookingSelects();
      }

      // deletion handlers (simple)
      document.addEventListener('click',e=>{
        const btn = e.target.closest('button[data-action^="del-"]');
        if(!btn) return;
        const id = parseInt(btn.dataset.id,10);
        const action = btn.dataset.action;
        switch(action){
          case 'del-owner': state.owners = state.owners.filter(o=>o.id!==id); state.boats.forEach(b=>{if(b.owner_id===id) b.owner_id=null});break;
          case 'del-boat': state.boats = state.boats.filter(b=>b.id!==id); state.bookings = state.bookings.filter(bk=>bk.boat_id!==id);break;
          case 'del-client': state.clients = state.clients.filter(c=>c.id!==id); state.bookings = state.bookings.filter(bk=>bk.client_id!==id);break;
          case 'del-route': state.routes = state.routes.filter(r=>r.id!==id); state.bookings = state.bookings.filter(bk=>bk.route_id!==id);break;
          case 'del-service': state.services = state.services.filter(s=>s.id!==id); state.boats.forEach(b=>{if(b.service_id===id) b.service_id=null});break;
          case 'del-booking': state.bookings = state.bookings.filter(bk=>bk.id!==id);break;
        }
        refreshAll();
      });

      // refresh button
      document.getElementById('refreshBtn').addEventListener('click',refreshAll);

      // initial view
      showView('dashboard');refreshAll();

      // global search (client-side simple filter)
      document.getElementById('globalSearch').addEventListener('input',e=>{
        const q = e.target.value.trim().toLowerCase();
        if(!q){refreshAll();return}
        // filter clients list as example
        const clientsTb = document.querySelector('#clientsList tbody');clientsTb.innerHTML='';const matched = state.clients.filter(c=>((c.first_name||'')+' '+(c.last_name||'')).toLowerCase().includes(q) || (c.phone||'').includes(q));if(matched.length===0){clientsTb.innerHTML='<tr><td colspan="5" class="small muted">No matches</td></tr>'}else{matched.forEach(c=>{const tr=document.createElement('tr');tr.innerHTML=`<td>${c.id}</td><td>${c.first_name} ${c.last_name||''}</td><td>${c.phone||''}</td><td>${c.city||''}</td><td></td>`;clientsTb.appendChild(tr)})}
      });

      // keyboard shortcut: n to open new on current view
      document.addEventListener('keydown',e=>{if(e.key==='n'){const active=document.querySelector('.nav-btn.active');if(active){const v=active.dataset.view;const mapping={owners:'owner',boats:'boat',clients:'client',routes:'route',services:'service',bookings:'booking'};openForm(mapping[v]);}}});

      // expose state to window for debugging
      window.__HBM = {state, refreshAll};
    })();
  </script>
</body>
</html>